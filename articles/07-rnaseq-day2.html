<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RNA-seq analysis in R • RNAseqRworkshop</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="RNA-seq analysis in R">
<meta property="og:description" content="RNAseqRworkshop">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RNAseqRworkshop</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/00-r-rstudio-intro.html">R for RNA-seq</a>
</li>
<li>
  <a href="../articles/06-rnaseq-day1.html">Differential expression analysis</a>
</li>
<li>
  <a href="../articles/08-applying-rnaseq.html">Applying RNA-seq</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Slides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/slides-01-rnaseq-basics.Rmd">RNA-seq basics</a>
    </li>
    <li>
      <a href="../articles/slides-02-rnaseq-filtering-qc.Rmd">Filtering and QC</a>
    </li>
    <li>
      <a href="../articles/slides-03-differential-expression-analysis.Rmd">Differential expression analysis</a>
    </li>
    <li>
      <a href="../articles/slides-04-gene-set-testing.Rmd">Gene set testing</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://mblue9.github.io/RNAseq-R_testing">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/mblue9/RNAseq-R_testing/">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="07-rnaseq-day2_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>RNA-seq analysis in R</h1>
            <h3 class="subtitle">Alignment and feature counting</h3>
                        <h4 class="author">Maria Doyle, Harriet Dashnow, Belinda Phipson</h4>
            
            <h4 class="date">27 April 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mblue9/RNAseq-R/blob/master/vignettes/07-rnaseq-day2.Rmd"><code>vignettes/07-rnaseq-day2.Rmd</code></a></small>
      <div class="hidden name"><code>07-rnaseq-day2.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Mapping reads to the genome is a very important task, and many different aligners are available, such as bowtie <span class="citation">(Langmead and Salzberg 2012)</span>, topHat <span class="citation">(Trapnell, Pachter, and Salzberg 2009)</span>, STAR <span class="citation">(Dobin et al. 2013)</span> and Rsubread <span class="citation">(Liao, Smyth, and Shi 2013)</span>. Rsubread is the only aligner that can run in R. Most mapping tasks require larger computers than an average laptop, so usually read mapping is done on a server in a Linux-like environment. However, for the purpose of this workshop, we will demonstrate how read alignment and counting can be performed using R. We will map a small subset of reads (1000) from each sample from our mouse lactation dataset <span class="citation">(Fu et al. 2015)</span>, and we will only be mapping to chromosome 1. This is so that everyone can have a go at alignment and counting on their laptops using RStudio.</p>
<div id="acknowledgements" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h2>
<p>This material was inspired by this <a href="(http://www.statsci.org/smyth/pubs/QLedgeRPreprint.pdf)">edgeR case study</a> by <span class="citation">(Lun, Chen, and Smyth 2016)</span> and this <a href="http://bioinf.wehi.edu.au/RNAseqCaseStudy/">Rsubread case study</a>.</p>
</div>
<div id="bioconductorr-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#bioconductorr-packages" class="anchor"></a>Bioconductor/R Packages</h2>
<p>Packages used:</p>
<ul>
<li>Rsubread</li>
</ul>
<p>To install the package you can:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span>
<span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op">(</span><span class="st">"Rsubread"</span><span class="op">)</span></code></pre></div>
</div>
<div id="data-files" class="section level2">
<h2 class="hasAnchor">
<a href="#data-files" class="anchor"></a>Data files</h2>
<ul>
<li>Mouse chromosome 1 Rsubread index files (~400MB).<br>
</li>
<li>12 fastq.gz files each containing 1000 reads (~1MB)</li>
</ul>
<p>Mouse mammary data (fastq files): <a href="https://figshare.com/s/f5d63d8c265a05618137">https://figshare.com/s/f5d63d8c265a05618137</a> You should download these files and place them in your <code>/data</code> directory. See below for how you can import from the links using R.</p>
<p>The raw reads were downloaded from SRA from the link given in <a href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE60450">GEO</a> for the dataset - <a href="ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP%2FSRP045%2FSRP045534" class="uri">ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP%2FSRP045%2FSRP045534</a>. These files are in .sra format. The sra toolkit from NCBI was used to convert the .sra files to .fastq files using the fastq-dump command and the first 1000 reads in each file was extracted.</p>
</div>
<div id="downloading-genome-files" class="section level2">
<h2 class="hasAnchor">
<a href="#downloading-genome-files" class="anchor"></a>Downloading genome files</h2>
<p>We have provided the index files for chromosome 1 for the mouse genome build mm10 for this workshop in order to save time on building the index. However, full genome fasta files for a number of different genomes are available to download from the UCSC genome browser, see <a href="http://hgdownload.soe.ucsc.edu/downloads.html" class="uri">http://hgdownload.soe.ucsc.edu/downloads.html</a>; from NCBI: <a href="http://www.ncbi.nlm.nih.gov/genome" class="uri">http://www.ncbi.nlm.nih.gov/genome</a>; or from ENSEMBL: <a href="http://asia.ensembl.org/info/data/ftp/index.html" class="uri">http://asia.ensembl.org/info/data/ftp/index.html</a>.</p>
</div>
</div>
<div id="importing-the-data" class="section level1">
<h1 class="hasAnchor">
<a href="#importing-the-data" class="anchor"></a># Importing the data</h1>
<p>First, let’s load the Rsubread package into R.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://bioconductor.org/packages/Rsubread">Rsubread</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># links to fastq files</span>
<span class="va">fastq_urls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"https://ndownloader.figshare.com/files/5053552?private_link=f5d63d8c265a05618137"</span>,
                <span class="st">"https://ndownloader.figshare.com/files/5053585?private_link=f5d63d8c265a05618137"</span>,
                <span class="st">"https://ndownloader.figshare.com/files/5053582?private_link=f5d63d8c265a05618137"</span>,
                <span class="st">"https://ndownloader.figshare.com/files/5053579?private_link=f5d63d8c265a05618137"</span>,
                <span class="st">"https://ndownloader.figshare.com/files/5053588?private_link=f5d63d8c265a05618137"</span>,
                <span class="st">"https://ndownloader.figshare.com/files/5053555?private_link=f5d63d8c265a05618137"</span>,
                <span class="st">"https://ndownloader.figshare.com/files/5053558?private_link=f5d63d8c265a05618137"</span>,
                <span class="st">"https://ndownloader.figshare.com/files/5053561?private_link=f5d63d8c265a05618137"</span>,
                <span class="st">"https://ndownloader.figshare.com/files/5053564?private_link=f5d63d8c265a05618137"</span>,
                <span class="st">"https://ndownloader.figshare.com/files/5053567?private_link=f5d63d8c265a05618137"</span>,
                <span class="st">"https://ndownloader.figshare.com/files/5053570?private_link=f5d63d8c265a05618137"</span>,
                <span class="st">"https://ndownloader.figshare.com/files/5053573?private_link=f5d63d8c265a05618137"</span><span class="op">)</span>
          
<span class="co"># names to save files as        </span>
<span class="va">fastq_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SRR1552444.fastq.gz"</span>, 
                 <span class="st">"SRR1552445.fastq.gz"</span>,
                 <span class="st">"SRR1552446.fastq.gz"</span>,
                 <span class="st">"SRR1552447.fastq.gz"</span>,
                 <span class="st">"SRR1552448.fastq.gz"</span>,
                 <span class="st">"SRR1552449.fastq.gz"</span>,
                 <span class="st">"SRR1552450.fastq.gz"</span>,
                 <span class="st">"SRR1552451.fastq.gz"</span>,
                 <span class="st">"SRR1552452.fastq.gz"</span>,
                 <span class="st">"SRR1552453.fastq.gz"</span>,
                 <span class="st">"SRR1552454.fastq.gz"</span>,
                 <span class="st">"SRR1552455.fastq.gz"</span><span class="op">)</span>

<span class="co"># download files into data directory</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">fastq_urls</span> <span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="va">fastq_urls</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"data/"</span>, <span class="va">fastq_names</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, mode<span class="op">=</span><span class="st">"wb"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># download mouse chr1 index files</span>
<span class="co"># these files are relatively large (~400MB total) so it may take a few minutes, the default timeout for download.file is 60 secs so you may need to increase it. We'll increase to 100 secs.</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>timeout<span class="op">=</span><span class="fl">100</span><span class="op">)</span>

<span class="va">chr1index_urls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"https://ndownloader.figshare.com/files/5053597?private_link=f5d63d8c265a05618137"</span>,
                    <span class="st">"https://ndownloader.figshare.com/files/5053600?private_link=f5d63d8c265a05618137"</span>,
                    <span class="st">"https://ndownloader.figshare.com/files/5053606?private_link=f5d63d8c265a05618137"</span>,
                    <span class="st">"https://ndownloader.figshare.com/files/5053603?private_link=f5d63d8c265a05618137"</span><span class="op">)</span>

<span class="va">chr1index_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chr1_mm10.00.b.array"</span>, 
                     <span class="st">"chr1_mm10.00.b.tab"</span>,
                     <span class="st">"chr1_mm10.files"</span>,
                     <span class="st">"chr1_mm10.reads"</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">chr1index_urls</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="va">chr1index_urls</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"data/"</span>, <span class="va">chr1index_names</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, mode<span class="op">=</span><span class="st">"wb"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>We put all the sequencing read data (.fastq.gz files) in the data directory. Now we need to tell the Rsubread aligner which files to look at. We can search for all .fastq.gz files in the data directory using the <code>list.files</code> command. The pattern argument takes a regular expression. In this case we are using the <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code> to mean the end of the string, so we will only get files that end in “.fastq.gz”</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fastq.files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"./data"</span>, pattern <span class="op">=</span> <span class="st">".fastq.gz$"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">fastq.files</span></code></pre></div>
<pre><code>##  [1] "./data/SRR1552444.fastq.gz" "./data/SRR1552445.fastq.gz"
##  [3] "./data/SRR1552446.fastq.gz" "./data/SRR1552447.fastq.gz"
##  [5] "./data/SRR1552448.fastq.gz" "./data/SRR1552449.fastq.gz"
##  [7] "./data/SRR1552450.fastq.gz" "./data/SRR1552451.fastq.gz"
##  [9] "./data/SRR1552452.fastq.gz" "./data/SRR1552453.fastq.gz"
## [11] "./data/SRR1552454.fastq.gz" "./data/SRR1552455.fastq.gz"</code></pre>
<div id="alignment" class="section level2">
<h2 class="hasAnchor">
<a href="#alignment" class="anchor"></a>Alignment</h2>
<div id="build-the-index" class="section level3">
<h3 class="hasAnchor">
<a href="#build-the-index" class="anchor"></a>Build the index</h3>
<p>Read sequences are stored in compressed (gzipped) FASTQ files. Before the differential expression analysis can proceed, these reads must be aligned to the mouse genome and counted into annotated genes. This can be achieved with functions in the Rsubread package.</p>
<p>The first step in performing the alignment is to build an index. In order to build an index you need to have the fasta file (.fa), which can be downloaded from the UCSC genome browser. Here we are building the index just for chromosome 1. This may take several minutes to run. Building the full index using the whole mouse genome usually takes about 30 minutes to an hr on a server. We won’t be building the index in the workshop due to time constraints, we have provided the index files for you. The command below assumes the chr1 genome information for mm10 is stored in the “chr1.fa” file.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># buildindex(basename="chr1_mm10",reference="chr1.fa")</span></code></pre></div>
<p>The above command will generate the index files in the working directory. In this example, the prefix for the index files is chr1_mm10. You can see the additional files generated using the <code>dir</code> command, which will list every file in your current working directory.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="aligning-reads-to-chromosome-1-of-reference-genome" class="section level3">
<h3 class="hasAnchor">
<a href="#aligning-reads-to-chromosome-1-of-reference-genome" class="anchor"></a>Aligning reads to chromosome 1 of reference genome</h3>
<p>Now that we have generated our index, we can align our reads using the <code>align</code> command. There are often numerous mapping parameters that we can specify, but usually the default mapping parameters for the <code>align</code> function are fine. If we had paired end data, we would specify the second read file/s using the <code>readfile2</code> argument. Our mouse data comprises 100bp single end reads.</p>
<p>We can specify the output files, or we can let <code>Rsubread</code> choose the output file names for us. The default output file name is the filename with “.subread.BAM” added at the end.</p>
<p>Now we can align our 12 fastq.gz files using the <code>align</code> command.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Rsubread/man/align.html">align</a></span><span class="op">(</span>index<span class="op">=</span><span class="st">"data/chr1_mm10"</span>,readfile1<span class="op">=</span><span class="va">fastq.files</span><span class="op">)</span></code></pre></div>
<p>This will align each of the 12 samples one after the other. As we’re only using a subset of 1000 reads per sample, aligning should just take a minute or so for each sample. To run the full samples from this dataset would take several hours per sample. The BAM files are saved in the working directory.</p>
<p>To see how many parameters you can change try the <code>args</code> function:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/args.html">args</a></span><span class="op">(</span><span class="va">align</span><span class="op">)</span></code></pre></div>
<pre><code>## function (index, readfile1, readfile2 = NULL, type = "rna", input_format = "gzFASTQ", 
##     output_format = "BAM", output_file = paste(readfile1, "subread", 
##         output_format, sep = "."), phredOffset = 33, nsubreads = 10, 
##     TH1 = 3, TH2 = 1, maxMismatches = 3, unique = FALSE, nBestLocations = 1, 
##     indels = 5, complexIndels = FALSE, nTrim5 = 0, nTrim3 = 0, 
##     minFragLength = 50, maxFragLength = 600, PE_orientation = "fr", 
##     nthreads = 1, readGroupID = NULL, readGroup = NULL, keepReadOrder = FALSE, 
##     sortReadsByCoordinates = FALSE, color2base = FALSE, DP_GapOpenPenalty = -1, 
##     DP_GapExtPenalty = 0, DP_MismatchPenalty = 0, DP_MatchScore = 2, 
##     detectSV = FALSE, useAnnotation = FALSE, annot.inbuilt = "mm10", 
##     annot.ext = NULL, isGTF = FALSE, GTF.featureType = "exon", 
##     GTF.attrType = "gene_id", chrAliases = NULL) 
## NULL</code></pre>
<p>In this example we have kept many of the default settings, which have been optimised to work well under a variety of situations. The default setting for <code>align</code> is that it only keeps reads that uniquely map to the reference genome. For testing differential expression of genes, this is what we want, as the reads are unambiguously assigned to one place in the genome, allowing for easier interpretation of the results. Understanding all the different parameters you can change involves doing a lot of reading about the aligner that you are using, and can take a lot of time to understand! Today we won’t be going into the details of the parameters you can change, but you can get more information from looking at the help:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span><span class="va">align</span></code></pre></div>
<p>We can get a summary of the proportion of reads that mapped to the reference genome using the <code>propmapped</code> function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bam.files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"./data"</span>, pattern <span class="op">=</span> <span class="st">".BAM$"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">bam.files</span></code></pre></div>
<pre><code>##  [1] "./data/SRR1552444.fastq.gz.subread.BAM"
##  [2] "./data/SRR1552445.fastq.gz.subread.BAM"
##  [3] "./data/SRR1552446.fastq.gz.subread.BAM"
##  [4] "./data/SRR1552447.fastq.gz.subread.BAM"
##  [5] "./data/SRR1552448.fastq.gz.subread.BAM"
##  [6] "./data/SRR1552449.fastq.gz.subread.BAM"
##  [7] "./data/SRR1552450.fastq.gz.subread.BAM"
##  [8] "./data/SRR1552451.fastq.gz.subread.BAM"
##  [9] "./data/SRR1552452.fastq.gz.subread.BAM"
## [10] "./data/SRR1552453.fastq.gz.subread.BAM"
## [11] "./data/SRR1552454.fastq.gz.subread.BAM"
## [12] "./data/SRR1552455.fastq.gz.subread.BAM"</code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">props</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rsubread/man/propmapped.html">propmapped</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">bam.files</span><span class="op">)</span>
<span class="va">props</span></code></pre></div>
<pre><code>##                                 NumTotal NumMapped PropMapped
## SRR1552444.fastq.gz.subread.BAM     1000       145      0.145
## SRR1552445.fastq.gz.subread.BAM     1000       136      0.136
## SRR1552446.fastq.gz.subread.BAM     1000       120      0.120
## SRR1552447.fastq.gz.subread.BAM     1000       113      0.113
## SRR1552448.fastq.gz.subread.BAM     1000        55      0.055
## SRR1552449.fastq.gz.subread.BAM     1000        76      0.076
## SRR1552450.fastq.gz.subread.BAM     1000       124      0.124
## SRR1552451.fastq.gz.subread.BAM     1000       160      0.160
## SRR1552452.fastq.gz.subread.BAM     1000       142      0.142
## SRR1552453.fastq.gz.subread.BAM     1000       151      0.151
## SRR1552454.fastq.gz.subread.BAM     1000       133      0.133
## SRR1552455.fastq.gz.subread.BAM     1000       116      0.116</code></pre>
<div id="challenge">
<p><i class="fas fa-pencil-alt"></i> <strong>Challenge</strong></p>
<ol style="list-style-type: decimal">
<li>Try aligning the fastq files allowing multi-mapping reads (set <code>unique = FALSE</code>), and allowing for up to 6 “best” locations to be reported (<code>nBestLocations = 6</code>). Specify the output file names (bam.files.multi) by substituting “.fastq.gz” with “.multi.bam” so we don’t overwrite our unique alignment bam files.</li>
<li>Look at the proportion of reads mapped and see if we get any more reads mapping by specifying a less stringent criteria.</li>
</ol>
</div>
</div>
</div>
<div id="quality-control" class="section level2">
<h2 class="hasAnchor">
<a href="#quality-control" class="anchor"></a>Quality control</h2>
<p>We can have a look at the quality scores associated with each base that has been called by the sequencing machine using the <code>qualityScores</code> function in <em>Rsubread</em>.</p>
<p>Let’s first extract quality scores for 100 reads for the file “SRR1552450.fastq.gz.”</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Extract quality scores</span>
<span class="va">qs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rsubread/man/qualityScores.html">qualityScores</a></span><span class="op">(</span>filename<span class="op">=</span><span class="st">"data/SRR1552450.fastq.gz"</span>,nreads<span class="op">=</span><span class="fl">100</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## qualityScores Rsubread 2.4.3
## 
## Scan the input file...
## Totally 1000 reads were scanned; the sampling interval is 9.
## Now extract read quality information...
## 
## Completed successfully. Quality scores for 100 reads (equally spaced in the file) are returned.</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Check dimension of qs</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">qs</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 100 100</code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Check first few elements of qs with head</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">qs</span><span class="op">)</span></code></pre></div>
<pre><code>##       1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
## [1,] 31 34 31 37 37 37 37 37 39 37 39 39 39 41 40 41 41 41 36 38 40 41 39 40 38
## [2,] 34 34 34 37 37 37 37 37 39 39 39 39 39 41 41 41 41 39 40 41 41 41 41 41 41
## [3,] 34 34 31 37 37 37 37 37 39 39 39 39 39 41 41 41 41 41 41 41 41 41 41 41 41
## [4,] 34 34 34 37 37 37 37 37 39 39 39 39 39 41 41 41 41 39 40 40 41 41 41 41 40
## [5,] 34 34 34 37 37 37 37 37 39 39 39 39 39 41 41 41 40 41 41 41 41 41 41 40 41
## [6,] 34 34 34 37 37 37 37 37 39 39 39 39 39 41 41 41 41 41 41 41 41 41 41 41 41
##      26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50
## [1,] 40 40 40 40 40 38 40 40 40 38 37 39 40 40 41 40 41 41 38 40 40 40 41 41 41
## [2,] 41 41 41 41 41 41 41 38 40 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41
## [3,] 41 41 41 41 40 40 41 38 38 38 40 41 40 41 39 40 40 41 41 41 39 40 38 40 40
## [4,] 41 41 41 41 41 40 41 41 41 41 40 41 41 41 41 41 41 41 41 41 41 41 41 41 41
## [5,] 41 41 41 41 39 40 41 41 41 41 40 41 41 41 41 41 41 41 41 41 41 41 41 41 41
## [6,] 36 40 40 41 41 41 41 40 38 40 38 40 41 41 40 41 41 41 40 40 41 40 40 40 41
##      51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75
## [1,] 40 40 36 40 38 37 37 35 35 33 35 35 33 35 34 35 35 35 34 34 34 35 35 35 35
## [2,] 41 41 41 41 41 41 41 40 41 41 41 39 39 39 39 37 37 37 37 36 36 36 34 36 35
## [3,] 37 39 40 41 41 40 37 39 39 39 37 37 37 37 37 37 36 36 35 36 35 33 35 35 35
## [4,] 41 41 41 41 41 40 40 41 40 41 41 41 41 40 41 41 39 39 39 39 37 37 37 37 37
## [5,] 41 40 41 41 41 41 40 41 41 41 38 40 41 41 41 41 39 39 39 39 39 38 37 37 37
## [6,] 40 39 33 36 35 34 35 35 35 35 35 35 35 33 33 33 34 31 31 34 29 34 33 34 35
##      76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99
## [1,] 35 35 35 36 35 35 35 34 34 35 34 35 35 35 35 35 35 35 35 35 35 35 35 35
## [2,] 35 35 35 35 35 35 35 35 35 37 35 36 35 35 35 35 35 35 36 36 35 35 34 34
## [3,] 35 34 36 35 35 34 35 35 35 34 35 35 35 35 35 33 35 35 35 31 34 35 35 33
## [4,] 37 36 36 36 36 36 36 35 35 35 35 35 35 35 35 35 34 35 35 35 35 35 35 35
## [5,] 37 37 35 35 35 35 35 36 35 35 35 35 35 35 35 35 35 35 36 35 35 35 35 35
## [6,] 32 32 34 34 33 31 34 34 18 24 32 33 35 35 27 32 31 32 34 34 35 34 34 33
##      100
## [1,]  33
## [2,]  35
## [3,]  33
## [4,]  35
## [5,]  35
## [6,]  34</code></pre>
<p>A quality score of 30 corresponds to a 1 in 1000 chance of an incorrect base call. (A quality score of 10 is a 1 in 10 chance of an incorrect base call.) To look at the overall distribution of quality scores across the 100 reads, we can look at a boxplot</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">qs</span><span class="op">)</span></code></pre></div>
<p><img src="07-rnaseq-day2_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div id="challenge">
<p><i class="fas fa-pencil-alt"></i> <strong>Challenge</strong></p>
<ol style="list-style-type: decimal">
<li>Extract quality scores for SRR1552451.fastq.gz for 50 reads.</li>
<li>Plot a boxplot of the quality scores for SRR1552451.fastq.gz.</li>
</ol>
</div>
</div>
<div id="counting" class="section level2">
<h2 class="hasAnchor">
<a href="#counting" class="anchor"></a>Counting</h2>
<p>Now that we have figured out where each read comes from in the genome, we need to summarise the information across genes or exons. The alignment produces a set of BAM files, where each file contains the read alignments for each library. In the BAM file, there is a chromosomal location for every read that mapped uniquely. The mapped reads can be counted across mouse genes by using the <code>featureCounts</code> function. <code>featureCounts</code> contains built-in annotation for mouse (mm9, mm10) and human (hg19) genome assemblies (NCBI refseq annotation).</p>
<p>The code below uses the exon intervals defined in the NCBI refseq annotation of the mm10 genome. Reads that map to exons of genes are added together to obtain the count for each gene, with some care taken with reads that span exon-exon boundaries. <code>featureCounts</code> takes all the BAM files as input, and outputs an object which includes the count matrix, similar to the count matrix we have been working with on Day 1. Each sample is a separate column, each row is a gene.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rsubread/man/featureCounts.html">featureCounts</a></span><span class="op">(</span><span class="va">bam.files</span>, annot.inbuilt<span class="op">=</span><span class="st">"mm10"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># See what slots are stored in fc</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">fc</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "counts"     "annotation" "targets"    "stat"</code></pre>
<p>The statistics of the read mapping can be seen with fc$stats. This reports the numbers of unassigned reads and the reasons why they are not assigned (eg. ambiguity, multi-mapping, secondary alignment, mapping quality, fragment length, chimera, read duplicate, non-junction and so on), in addition to the number of successfully assigned reads for each library. (We know the real reason why the majority of the reads aren’t mapping - they’re not from chr 1!)</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Take a look at the featurecounts stats</span>
<span class="va">fc</span><span class="op">$</span><span class="va">stat</span></code></pre></div>
<pre><code>##                           Status SRR1552444.fastq.gz.subread.BAM
## 1                       Assigned                              50
## 2            Unassigned_Unmapped                             855
## 3           Unassigned_Read_Type                               0
## 4           Unassigned_Singleton                               0
## 5      Unassigned_MappingQuality                               0
## 6             Unassigned_Chimera                               0
## 7      Unassigned_FragmentLength                               0
## 8           Unassigned_Duplicate                               0
## 9        Unassigned_MultiMapping                               0
## 10          Unassigned_Secondary                               0
## 11           Unassigned_NonSplit                               0
## 12         Unassigned_NoFeatures                              95
## 13 Unassigned_Overlapping_Length                               0
## 14          Unassigned_Ambiguity                               0
##    SRR1552445.fastq.gz.subread.BAM SRR1552446.fastq.gz.subread.BAM
## 1                               45                              34
## 2                              864                             880
## 3                                0                               0
## 4                                0                               0
## 5                                0                               0
## 6                                0                               0
## 7                                0                               0
## 8                                0                               0
## 9                                0                               0
## 10                               0                               0
## 11                               0                               0
## 12                              90                              86
## 13                               0                               0
## 14                               1                               0
##    SRR1552447.fastq.gz.subread.BAM SRR1552448.fastq.gz.subread.BAM
## 1                               34                              13
## 2                              887                             945
## 3                                0                               0
## 4                                0                               0
## 5                                0                               0
## 6                                0                               0
## 7                                0                               0
## 8                                0                               0
## 9                                0                               0
## 10                               0                               0
## 11                               0                               0
## 12                              79                              41
## 13                               0                               0
## 14                               0                               1
##    SRR1552449.fastq.gz.subread.BAM SRR1552450.fastq.gz.subread.BAM
## 1                               21                              50
## 2                              924                             876
## 3                                0                               0
## 4                                0                               0
## 5                                0                               0
## 6                                0                               0
## 7                                0                               0
## 8                                0                               0
## 9                                0                               0
## 10                               0                               0
## 11                               0                               0
## 12                              55                              73
## 13                               0                               0
## 14                               0                               1
##    SRR1552451.fastq.gz.subread.BAM SRR1552452.fastq.gz.subread.BAM
## 1                               69                              50
## 2                              840                             858
## 3                                0                               0
## 4                                0                               0
## 5                                0                               0
## 6                                0                               0
## 7                                0                               0
## 8                                0                               0
## 9                                0                               0
## 10                               0                               0
## 11                               0                               0
## 12                              91                              90
## 13                               0                               0
## 14                               0                               2
##    SRR1552453.fastq.gz.subread.BAM SRR1552454.fastq.gz.subread.BAM
## 1                               53                              55
## 2                              849                             867
## 3                                0                               0
## 4                                0                               0
## 5                                0                               0
## 6                                0                               0
## 7                                0                               0
## 8                                0                               0
## 9                                0                               0
## 10                               0                               0
## 11                               0                               0
## 12                              97                              78
## 13                               0                               0
## 14                               1                               0
##    SRR1552455.fastq.gz.subread.BAM
## 1                               42
## 2                              884
## 3                                0
## 4                                0
## 5                                0
## 6                                0
## 7                                0
## 8                                0
## 9                                0
## 10                               0
## 11                               0
## 12                              74
## 13                               0
## 14                               0</code></pre>
<p>The counts for the samples are stored in fc$counts. Take a look at that.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Take a look at the dimensions to see the number of genes</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">fc</span><span class="op">$</span><span class="va">counts</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 27179    12</code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Take a look at the first 6 lines</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fc</span><span class="op">$</span><span class="va">counts</span><span class="op">)</span></code></pre></div>
<pre><code>##           SRR1552444.fastq.gz.subread.BAM SRR1552445.fastq.gz.subread.BAM
## 497097                                  0                               0
## 100503874                               0                               0
## 100038431                               0                               0
## 19888                                   0                               0
## 20671                                   0                               0
## 27395                                   0                               0
##           SRR1552446.fastq.gz.subread.BAM SRR1552447.fastq.gz.subread.BAM
## 497097                                  0                               0
## 100503874                               0                               0
## 100038431                               0                               0
## 19888                                   0                               0
## 20671                                   0                               0
## 27395                                   0                               0
##           SRR1552448.fastq.gz.subread.BAM SRR1552449.fastq.gz.subread.BAM
## 497097                                  0                               0
## 100503874                               0                               0
## 100038431                               0                               0
## 19888                                   0                               0
## 20671                                   0                               0
## 27395                                   0                               0
##           SRR1552450.fastq.gz.subread.BAM SRR1552451.fastq.gz.subread.BAM
## 497097                                  0                               0
## 100503874                               0                               0
## 100038431                               0                               0
## 19888                                   0                               0
## 20671                                   0                               0
## 27395                                   0                               0
##           SRR1552452.fastq.gz.subread.BAM SRR1552453.fastq.gz.subread.BAM
## 497097                                  0                               0
## 100503874                               0                               0
## 100038431                               0                               0
## 19888                                   0                               0
## 20671                                   0                               0
## 27395                                   0                               0
##           SRR1552454.fastq.gz.subread.BAM SRR1552455.fastq.gz.subread.BAM
## 497097                                  0                               0
## 100503874                               0                               0
## 100038431                               0                               0
## 19888                                   0                               0
## 20671                                   0                               0
## 27395                                   0                               0</code></pre>
<p>The row names of the fc$counts matrix represent the Entrez gene identifiers for each gene and the column names are the output filenames from calling the <code>align</code> function. The <code>annotation</code> slot shows the annotation information that <code>featureCounts</code> used to summarise reads over genes.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fc</span><span class="op">$</span><span class="va">annotation</span><span class="op">)</span></code></pre></div>
<pre><code>##      GeneID                           Chr
## 1    497097                chr1;chr1;chr1
## 2 100503874                     chr1;chr1
## 3 100038431                          chr1
## 4     19888 chr1;chr1;chr1;chr1;chr1;chr1
## 5     20671      chr1;chr1;chr1;chr1;chr1
## 6     27395      chr1;chr1;chr1;chr1;chr1
##                                             Start
## 1                         3214482;3421702;3670552
## 2                                 3647309;3658847
## 3                                         3680155
## 4 4290846;4343507;4351910;4352202;4360200;4409170
## 5         4490928;4493100;4493772;4495136;4496291
## 6         4773198;4777525;4782568;4783951;4785573
##                                               End      Strand Length
## 1                         3216968;3421901;3671498       -;-;-   3634
## 2                                 3650509;3658904         -;-   3259
## 3                                         3681788           +   1634
## 4 4293012;4350091;4352081;4352837;4360314;4409241 -;-;-;-;-;-   9747
## 5         4492668;4493466;4493863;4495942;4496413   -;-;-;-;-   3130
## 6         4776801;4777648;4782733;4784105;4785726   -;-;-;-;-   4203</code></pre>
<div id="challenge">
<p><i class="fas fa-pencil-alt"></i> <strong>Challenge</strong></p>
<ol style="list-style-type: decimal">
<li>Redo the counting over the exons, rather than the genes (specify <code>useMetaFeatures = FALSE</code>). Use the bam files generated doing alignment reporting only unique reads, and call the <code>featureCounts</code> object <code>fc.exon</code>. Check the dimension of the counts slot to see how much larger it is.</li>
<li>Using your “.multi.bam” files, redo the counting over genes, allowing for multimapping reads (specify <code>countMultiMappingReads = TRUE</code>), calling the object <code>fc.multi</code>. Check the stats.</li>
</ol>
</div>
<p>Notes</p>
<ul>
<li>If you are sequencing your own data, the sequencing facility will almost always provide fastq files.<br>
</li>
<li>For publicly available sequence data from GEO/SRA, the files are usually in the Sequence Read Archive (SRA) format. Prior to read alignment, these files need to be converted into the FASTQ format using the fastq-dump utility from the SRA Toolkit. See http: //www.ncbi.nlm.nih.gov/books/NBK158900 for how to download and use the SRA Toolkit.<br>
</li>
<li>By default, alignment is performed with <code>unique=TRUE</code>. If a read can be aligned to two or more locations, <em>Rsubread</em> will attempt to select the best location using a number of criteria. Only reads that have a unique best location are reported as being aligned. Keeping this default is recommended, as it avoids spurious signal from non-uniquely mapped reads derived from, e.g., repeat regions.<br>
</li>
<li>The Phred offset determines the encoding for the base-calling quality string in the FASTQ file. For the Illumina 1.8 format onwards, this encoding is set at +33. However, older formats may use a +64 encoding. Users should ensure that the correct encoding is specified during alignment. If unsure, one can examine the first several quality strings in the FASTQ file. A good rule of thumb is to check whether lower-case letters are present (+64 encoding) or absent (+33).<br>
</li>
<li>
<code>featureCounts</code> requires gene annotation specifying the genomic start and end position of each exon of each gene. <em>Rsubread</em> contains built-in gene annotation for mouse and human. For other species, users will need to read in a data frame in GTF format to define the genes and exons. Users can also specify a custom annotation file in SAF format. See the Rsubread users guide for more information, or try <code><a href="https://rdrr.io/pkg/Rsubread/man/featureCounts.html">?featureCounts</a></code>, which has an example of what an SAF file should like like.</li>
</ul>
</div>
</div>
<div id="package-versions-used" class="section level1">
<h1 class="hasAnchor">
<a href="#package-versions-used" class="anchor"></a>Package versions used</h1>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.0.3 (2020-10-10)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04 LTS
## 
## Matrix products: default
## BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.8.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=C             
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] Rsubread_2.4.3
## 
## loaded via a namespace (and not attached):
##  [1] lattice_0.20-41   rprojroot_2.0.2   digest_0.6.27     crayon_1.4.1     
##  [5] grid_4.0.3        R6_2.5.0          magrittr_2.0.1    evaluate_0.14    
##  [9] highr_0.9         stringi_1.5.3     rlang_0.4.10      cachem_1.0.4     
## [13] fs_1.5.0          Matrix_1.3-2      ragg_1.1.2        rmarkdown_2.7    
## [17] pkgdown_1.6.1     textshaping_0.3.3 desc_1.3.0        tools_4.0.3      
## [21] stringr_1.4.0     yaml_2.2.1        xfun_0.22         fastmap_1.1.0    
## [25] compiler_4.0.3    systemfonts_1.0.1 memoise_2.0.0     htmltools_0.5.1.1
## [29] knitr_1.33</code></pre>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Dobin2013" class="csl-entry">
Dobin, Alexander, Carrie A Davis, Felix Schlesinger, Jorg Drenkow, Chris Zaleski, Sonali Jha, Philippe Batut, Mark Chaisson, and Thomas R Gingeras. 2013. <span>“<span class="nocase">STAR: ultrafast universal RNA-seq aligner.</span>”</span> <em>Bioinformatics (Oxford, England)</em> 29 (1): 15–21. <a href="https://doi.org/10.1093/bioinformatics/bts635">https://doi.org/10.1093/bioinformatics/bts635</a>.
</div>
<div id="ref-Fu2015" class="csl-entry">
Fu, Nai Yang, Anne C Rios, Bhupinder Pal, Rina Soetanto, Aaron T L Lun, Kevin Liu, Tamara Beck, et al. 2015. <span>“<span class="nocase">EGF-mediated induction of Mcl-1 at the switch to lactation is essential for alveolar cell survival.</span>”</span> <em>Nature Cell Biology</em> 17 (4): 365–75. <a href="https://doi.org/10.1038/ncb3117">https://doi.org/10.1038/ncb3117</a>.
</div>
<div id="ref-Langmead2012" class="csl-entry">
Langmead, Ben, and Steven L Salzberg. 2012. <span>“<span class="nocase">Fast gapped-read alignment with Bowtie 2.</span>”</span> <em>Nature Methods</em> 9 (4): 357–59. <a href="https://doi.org/10.1038/nmeth.1923">https://doi.org/10.1038/nmeth.1923</a>.
</div>
<div id="ref-liao2013subread" class="csl-entry">
Liao, Yang, Gordon K Smyth, and Wei Shi. 2013. <span>“<span class="nocase">The Subread aligner: fast, accurate and scalable read mapping by seed-and-vote</span>.”</span> <em>Nucleic Acids Research</em> 41: 16 pages.
</div>
<div id="ref-Lun2016" class="csl-entry">
Lun, Aaron T L, Yunshun Chen, and Gordon K Smyth. 2016. <span>“<span class="nocase">It’s DE-licious: A Recipe for Differential Expression Analyses of RNA-seq Experiments Using Quasi-Likelihood Methods in edgeR.</span>”</span> <em>Methods in Molecular Biology (Clifton, N.J.)</em> 1418 (January): 391–416. <a href="https://doi.org/10.1007/978-1-4939-3578-9%5C_19">https://doi.org/10.1007/978-1-4939-3578-9\_19</a>.
</div>
<div id="ref-trapnell2009tophat" class="csl-entry">
Trapnell, Cole, Lior Pachter, and Steven L Salzberg. 2009. <span>“<span class="nocase">TopHat: discovering splice junctions with RNA-seq</span>.”</span> <em>Bioinformatics</em> 25 (9): 1105–11. <a href="https://doi.org/doi:10.1093/bioinformatics/btp120">https://doi.org/doi:10.1093/bioinformatics/btp120</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Maria Doyle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
